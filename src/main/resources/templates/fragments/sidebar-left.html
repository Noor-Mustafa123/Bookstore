<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Bookstore Fragment: sidebar-left</title>
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>

<div id="sidebar-left" th:fragment="sidebar-left">
    <script th:src="@{/js/sidebar.js}"></script>
    <!-- AUTHOR LIST -->
    <div class="sidebar-left-div">
        <p class="sidebar-left-title">Authors</p>
        <div class="sidebar-left-list" id="authors-list">
            <th:block th:each="author, authorStat: ${authors}">
                <a class="sidebar-left-list-item"
                   th:classappend="${authorStat.index >= 10 ? 'more-item' : ''}"
                   th:href="@{/search(query=${author}, type='BOOK')}"
                   th:text="${author}"></a>
            </th:block>
            <div th:if="${#lists.size(authors) > 10}">
                <a class="sidebar-left-list-item float-right show-more-link more-less-link"
                   href="javascript:toggleVisibility('authors-list', 'show-more-link', 'show-less-link')">
                    More...
                </a>
                <a class="sidebar-left-list-item float-right show-less-link more-less-link"
                   href="javascript:toggleVisibility('authors-list', 'show-more-link', 'show-less-link')"
                   style="display: none">
                    Less...
                </a>
            </div>
        </div>
    </div>
    <!-- GENRE LIST -->
    <div class="sidebar-left-div">
        <p class="sidebar-left-title">Genres</p>
        <div class="sidebar-left-list" id="genres-list">
            <th:block th:each="genre, genreStat: ${genres}">
                <a class="sidebar-left-list-item"
                   th:classappend="${genreStat.index >= 10 ? 'more-item' : ''}"
                   th:href="@{/search(genres=${genre.name()}, type='BOOK')}"
                   th:text="${genre.displayName}"></a>
            </th:block>
            <div th:if="${#lists.size(genres) > 10}">
                <a class="sidebar-left-list-item float-right show-more-link more-less-link"
                   href="javascript:toggleVisibility('genres-list', 'show-more-link', 'show-less-link')">
                    More...
                </a>
                <a class="sidebar-left-list-item float-right show-less-link more-less-link"
                   href="javascript:toggleVisibility('genres-list', 'show-more-link', 'show-less-link')"
                   style="display: none">
                    Less...
                </a>
            </div>
        </div>
    </div>
    <!-- LATEST REVIEW -->
    <div class="sidebar-left-div" th:if="${_latestReview}">
        <p class="sidebar-left-title">Latest Review</p>
        <div class="sidebar-left-list">
            <a class="sidebar-left-list-item"
               th:href="@{/api/v1/books/{id}(id=${_latestReview.bookId()})}"
               th:text="${_latestReview.bookTitle()}"></a>
            <div class="flex-row space-between sidebar-left-list-item">
                <p class="rating-score">
                    <b><span th:text="${_latestReview.rating()}"></span> / 5</b>
                </p>
                <p th:text="${_latestReviewDate}"></p>
            </div>
            <div class="sidebar-left-list-item"
                 th:if="${!#strings.isEmpty(_latestReview.content())}">
                <th:block th:if="${_latestReview.content().length() > 100}">
                    <p th:text="${#strings.abbreviate(_latestReview.content(), 100)}"></p>
                </th:block>
                <th:block th:if="${_latestReview.content().length() <= 100}">
                    <p th:text="${_latestReview.content()}"></p>
                </th:block>
            </div>
            <div class="sidebar-left-list-item"
                 th:if="${#strings.isEmpty(_latestReview.content())}">
                <p class="gray-text">No content was provided for this review</p>
            </div>
            <div>
                <p class="float-right">
                    - <span th:text="${_latestReview.userDisplayName()}"></span>
                </p>
            </div>
        </div>
    </div>
</div>

</body>
</html>